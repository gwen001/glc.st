<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Gwendal Le Coguic">
    <meta name="description" content="Gwendal Le Coguic, developer, bug hunter, independent cybersecurity expert">
    <meta name="keywords" content="developer,webapp,cybersecurity,researcher,pentest,bugbounty,cybertools,bash,php,python,golang,offsectools">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://glc.st/assets/img/header-background.jpg"/>

<meta name="twitter:title" content="DVWA - Insecure CAPTCHA"/>
<meta name="twitter:description" content="Captchas are usually used to prevent robots to make an action instead of humans.
It should add an extra layer of security but badly configured it could lead to unauthorized access&hellip;
When you try to submit the form without providing a captcha code, you get the following error:

Low
Try to submit an empty password and take a look to the HTTP request and her parameters, you can notice the strange variable step:

This variable is the step in the change password functionnality.
So if you simply change it to 2 and replay the request with this new value, it works perfectly."/>
<meta name="twitter:site" content="@Gwendal Le Coguic"/>
<meta name="twitter:creator" content="@gwendallecoguic"/>

    <meta property="og:title" content="DVWA - Insecure CAPTCHA" />
<meta property="og:description" content="Captchas are usually used to prevent robots to make an action instead of humans.
It should add an extra layer of security but badly configured it could lead to unauthorized access&hellip;
When you try to submit the form without providing a captcha code, you get the following error:

Low
Try to submit an empty password and take a look to the HTTP request and her parameters, you can notice the strange variable step:

This variable is the step in the change password functionnality.
So if you simply change it to 2 and replay the request with this new value, it works perfectly." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://glc.st/posts/dvwa-insecure-captcha/" />

<meta property="og:image" content="https://glc.st/assets/img/header-background.jpg" />
<meta property="article:published_time" content="2015-03-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-03-13T00:00:00+00:00" /><meta property="og:site_name" content="Gwendal Le Coguic" />


    
      <base href="https://glc.st/posts/dvwa-insecure-captcha/">
    
    <title>
    DVWA - Insecure CAPTCHA · Gwendal Le Coguic
</title>

    
      <link rel="canonical" href="https://glc.st/posts/dvwa-insecure-captcha/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

    
      
      
      <link rel="stylesheet" href="https://glc.st/assets/css/coder.min.3d8325016df2bf0f0e874e28c83131f668a953cb3245cf9391fae4ff5b76b2ed.css" integrity="sha256-PYMlAW3yvw8Oh04oyDEx9mipU8syRc&#43;Tkfrk/1t2su0=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://glc.st/assets/css/custom.css" />
    

    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-256x256.png" sizes="256x256">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-128x128.png" sizes="128x128">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.147.0">
  </head>

  <body class=" ">
        <main class="wrapper">
      <nav class="navigation d-print-none">
  <section class="container">
    <a class="navigation-title" href="https://glc.st/">
      Gwendal Le Coguic
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/courses/">Courses</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/clients/">Clients</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/cves/">CVEs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/press/">Press</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
<section class="container post">
    <div id="sharer">
    <div class="sharer-buttons">

        <a href="https://twitter.com/intent/tweet?text=DVWA%20-%20Insecure%20CAPTCHA%20https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f" target="_blank"><img class="twitter" src="https://glc.st/assets/img/share/twitter.svg" alt="twitter"></a>
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f&title=DVWA%20-%20Insecure%20CAPTCHA" target="_blank"><img class="reddit" src="https://glc.st/assets/img/share/reddit.svg" alt="reddit"></a>
        <a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f&amp;t=DVWA%20-%20Insecure%20CAPTCHA" target="_blank"><img class="hackernews" src="https://glc.st/assets/img/share/hackernews.svg" alt="hackernews"></a>
        <a href="mailto:?subject=DVWA%20-%20Insecure%20CAPTCHA&body=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f" target="_blank"><img class="mail" src="https://glc.st/assets/img/share/mail.svg" alt="mail"></a>
        <a href="https://wa.me/?text=DVWA%20-%20Insecure%20CAPTCHA%20https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f" target="_blank"><img class="whatsapp" src="https://glc.st/assets/img/share/whatsapp.svg" alt="facebook"></a>
        <a href="https://t.me/share/url?url=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f&text=DVWA%20-%20Insecure%20CAPTCHA" target="_blank"><img class="telegram" src="https://glc.st/assets/img/share/telegram.svg" alt="facebook"></a>
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f&amp;title=DVWA%20-%20Insecure%20CAPTCHA" target="_blank"><img class="linkedin" src="https://glc.st/assets/img/share/linkedin.svg" alt="linkedin"></a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fglc.st%2fposts%2fdvwa-insecure-captcha%2f&t=DVWA%20-%20Insecure%20CAPTCHA" target="_blank"><img class="facebook" src="https://glc.st/assets/img/share/facebook.svg" alt="facebook"></a>

        
    </div>
</div>


    <article>
        <header>
            <div class="post-title">
                <h1 class="title">DVWA - Insecure CAPTCHA</h1>
            </div>
            <div class="post-meta">
                <div class="date">
                    <span class="posted-on">
                        <i class="fas fa-calendar"></i>
                        <time datetime='2015-03-13T00:00:00Z'>
                            March 13, 2015
                        </time>
                    </span>
                    <span class="reading-time">
                        <i class="fas fa-clock"></i>
                        2 minutes read
                    </span>
                </div>
                
                <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://glc.st/tags/dvwa/">dvwa</a>
      <span class="separator">•</span>
    <a href="https://glc.st/tags/captcha/">captcha</a></div>

            </div>
        </header>

        <div>
            <p>Captchas are usually used to prevent robots to make an action instead of humans.
It should add an extra layer of security but badly configured it could lead to unauthorized access&hellip;</p>
<p>When you try to submit the form without providing a captcha code, you get the following error:</p>
<p><img src="https://glc.st/images/dvwa-captcha-error.png" alt="dvwa captcha error"></p>
<h2 id="low">Low</h2>
<p>Try to submit an empty password and take a look to the HTTP request and her parameters, you can notice the strange variable <code>step</code>:</p>
<p><img src="https://glc.st/images/dvwa-captcha-low.png" alt="dvwa captcha low"></p>
<p>This variable is the step in the change password functionnality.
So if you simply change it to <code>2</code> and replay the request with this new value, it works perfectly.</p>
<h2 id="medium">Medium</h2>
<p>In this level another step has been added. 
After submitting your new password and the good captcha you&rsquo;ll have to confirm your wish by submitting another form:</p>
<p><img src="https://glc.st/images/dvwa-captcha-medium.png" alt="dvwa captcha medium"></p>
<p>Again, if you check the parameters of this second request, you can notice a new field called <code>passed_captcha</code> set to <code>true</code>.
Now if you merge the both requests and apply the same method viewed in the first level, you are able to change your password within only one request:</p>
<p><img src="https://glc.st/images/dvwa-aptcha-medium.png" alt="dvwa captcha medium"></p>
<h2 id="high">High</h2>
<p>As usual the highest level is well configured and cannot be bypassed.
The check is done within only one step by calling the method <code>captcha_check_answer()</code>.
Plus note how the SQL query is protected from injection with <code>mysql_real_escape_string()</code>.</p>
        </div>

        <footer>
            


        </footer>
    </article>

    
</section>

      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRF716WMB7"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NRF716WMB7');
        }
      </script>

    
      <script src="https://glc.st/assets/js/scripts.js"></script>
    

  </body>

</html>
