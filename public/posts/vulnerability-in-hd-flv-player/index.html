<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Gwendal Le Coguic">
    <meta name="description" content="Gwendal Le Coguic, developer, bug hunter, independent cybersecurity expert">
    <meta name="keywords" content="developer,webapp,cybersecurity,researcher,pentest,bugbounty,cybertools,bash,php,python,golang,offsectools">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://glc.st/assets/img/header-background.jpg"/>

<meta name="twitter:title" content="Vulnerability in HD FLV Player"/>
<meta name="twitter:description" content="Reported by Sucuri,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.
The vulnerable code can be found in download.php:
&lt;?php
$filename = $_GET[&#39;f&#39;];
header(&#39;Content-disposition: attachment; filename=&#39;.basename($filename));
readfile($filename);
?&gt;
Since there is absolutly no check nor filter applied before using the f parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed."/>
<meta name="twitter:site" content="@Gwendal Le Coguic"/>
<meta name="twitter:creator" content="@gwendallecoguic"/>

    <meta property="og:title" content="Vulnerability in HD FLV Player" />
<meta property="og:description" content="Reported by Sucuri,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.
The vulnerable code can be found in download.php:
&lt;?php
$filename = $_GET[&#39;f&#39;];
header(&#39;Content-disposition: attachment; filename=&#39;.basename($filename));
readfile($filename);
?&gt;
Since there is absolutly no check nor filter applied before using the f parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://glc.st/posts/vulnerability-in-hd-flv-player/" />

<meta property="og:image" content="https://glc.st/assets/img/header-background.jpg" />
<meta property="article:published_time" content="2014-12-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-12-15T00:00:00+00:00" /><meta property="og:site_name" content="Gwendal Le Coguic" />


    
      <base href="https://glc.st/posts/vulnerability-in-hd-flv-player/">
    
    <title>
    Vulnerability in HD FLV Player · Gwendal Le Coguic
</title>

    
        
            <link rel="canonical" href="https://glc.st/posts/vulnerability-in-hd-flv-player/">
        
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

    
      
      
      <link rel="stylesheet" href="https://glc.st/assets/css/coder.min.3d8325016df2bf0f0e874e28c83131f668a953cb3245cf9391fae4ff5b76b2ed.css" integrity="sha256-PYMlAW3yvw8Oh04oyDEx9mipU8syRc&#43;Tkfrk/1t2su0=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://glc.st/assets/css/custom.css" />
    

    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-256x256.png" sizes="256x256">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-128x128.png" sizes="128x128">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://glc.st/assets/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.147.0">
  </head>

  <body class=" ">
        <main class="wrapper">
      <div id="google_translate_element"></div>

<style>
 #google_translate_element {
    float: left;
    width: 150px;
    display: none;
 }
  
</style>
<script type="text/javascript">
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL}, 'google_translate_element');
    }
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

      <nav class="navigation d-print-none">
  <section class="container">
    <a class="navigation-title" href="https://glc.st/">
      Gwendal Le Coguic
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/courses/">Courses</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/clients/">Clients</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/cves/">CVEs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://glc.st/press/">Press</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


<script>
    
    
    

    
    

    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    
    
</script>


      <div class="content">
        
<section class="container post">
    <div id="sharer">
    <div class="sharer-buttons">

        <a href="https://twitter.com/intent/tweet?text=Vulnerability%20in%20HD%20FLV%20Player%20https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f" target="_blank"><img class="twitter" src="https://glc.st/assets/img/share/twitter.svg" alt="twitter"></a>
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f&title=Vulnerability%20in%20HD%20FLV%20Player" target="_blank"><img class="reddit" src="https://glc.st/assets/img/share/reddit.svg" alt="reddit"></a>
        <a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f&amp;t=Vulnerability%20in%20HD%20FLV%20Player" target="_blank"><img class="hackernews" src="https://glc.st/assets/img/share/hackernews.svg" alt="hackernews"></a>
        <a href="mailto:?subject=Vulnerability%20in%20HD%20FLV%20Player&body=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f" target="_blank"><img class="mail" src="https://glc.st/assets/img/share/mail.svg" alt="mail"></a>
        <a href="https://wa.me/?text=Vulnerability%20in%20HD%20FLV%20Player%20https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f" target="_blank"><img class="whatsapp" src="https://glc.st/assets/img/share/whatsapp.svg" alt="facebook"></a>
        <a href="https://t.me/share/url?url=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f&text=Vulnerability%20in%20HD%20FLV%20Player" target="_blank"><img class="telegram" src="https://glc.st/assets/img/share/telegram.svg" alt="facebook"></a>
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f&amp;title=Vulnerability%20in%20HD%20FLV%20Player" target="_blank"><img class="linkedin" src="https://glc.st/assets/img/share/linkedin.svg" alt="linkedin"></a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fglc.st%2fposts%2fvulnerability-in-hd-flv-player%2f&t=Vulnerability%20in%20HD%20FLV%20Player" target="_blank"><img class="facebook" src="https://glc.st/assets/img/share/facebook.svg" alt="facebook"></a>

        
    </div>
</div>


    <article>
        <header>
            <div class="post-title">
                <h1 class="title">Vulnerability in HD FLV Player</h1>
            </div>
            <div class="post-meta">
                <div class="date">
                    <span class="posted-on">
                        <i class="fas fa-calendar"></i>
                        <time datetime='2014-12-15T00:00:00Z'>
                            December 15, 2014
                        </time>
                    </span>
                    <span class="reading-time">
                        <i class="fas fa-clock"></i>
                        One minute read
                    </span>
                </div>
                
                <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://glc.st/tags/joomla/">joomla</a>
      <span class="separator">•</span>
    <a href="https://glc.st/tags/file-download/">file download</a>
      <span class="separator">•</span>
    <a href="https://glc.st/tags/hd-flv-player/">hd flv player</a>
      <span class="separator">•</span>
    <a href="https://glc.st/tags/wordpress/">wordpress</a></div>

            </div>
        </header>

        <div>
            <p>Reported by <a href="http://blog.sucuri.net/2014/12/critical-vulnerability-in-joomla-hd-flv-player-plugin.html" title="Sucuri">Sucuri</a>,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.</p>
<p>The vulnerable code can be found in <code>download.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$filename <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;f&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-disposition: attachment; filename=&#39;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">basename</span>($filename));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">readfile</span>($filename);
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Since there is absolutly no check nor filter applied before using the <code>f</code> parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed.</p>
<p>Here is a POC on my local Wordpress (same result might append with Joomla):</p>
<p><img src="https://glc.st/images/hd_flv_player_wordpress_poc.png" alt="hd flv player wordpress poc"></p>
<p>The wierd thing is that the Wordpress and Joomla plugins have been patched but <strong>not the archive</strong> on
<a href="http://www.hdflvplayer.net/hd-flv-player-download.php" title="HD FLV Player">HD FLV Player official website</a>, leaving custom installations vulnerable.</p>
<p>Note: As Sucuri said, <code>email.php</code> should be considered too but the vulnerability is little more tricky.</p>
        </div>

        <footer>
            


        </footer>
    </article>

    
</section>

      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRF716WMB7"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NRF716WMB7');
        }
      </script>

    
      <script src="https://glc.st/assets/js/scripts.js"></script>
    

  </body>

</html>
